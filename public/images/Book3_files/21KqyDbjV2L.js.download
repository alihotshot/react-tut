(function(e){var c=window.AmazonUIPageJS||window.P,h=c._namespace||c.attributeErrors,f=h?h("StarlingInterestGroupAssignment",""):c;f.guardFatal?f.guardFatal(e)(f,window):f.execute(function(){e(f,window)})})(function(e,c,h){e.now("StarlingIGJoinConfiguration").execute(function(c){c||e.register("StarlingIGJoinConfiguration",function(){return{getRoboticSessionId:function(){return"000-0000000-0000000"},getSecondsPerDay:function(){return 86400},getToken:function(a){switch(a){case "gamma":return"A3NCr8P3b4bphoI4ddXo62kjJE+2Pvsn0XussvUJBWUV1CAaU84jhrQcNmXQfqRf2N6L4BEaDAvtTmGLsSMHOAsAAACJeyJvcmlnaW4iOiJodHRwczovL3ByZS1wcm9kLmFtYXpvbi5jb206NDQzIiwiZmVhdHVyZSI6IlByaXZhY3lTYW5kYm94QWRzQVBJcyIsImV4cGlyeSI6MTY4ODA4MzE5OSwiaXNTdWJkb21haW4iOnRydWUsImlzVGhpcmRQYXJ0eSI6dHJ1ZX0\x3d";
case "prod":return"A1ZuudJAyStrz04rn6qN6wKO4Z+jLb3xT7BXazMW8G6hp4Gb2yBAwOIYY3Zs3XipJjwtXGLD8wqGFYkA5uzA0w8AAACEeyJvcmlnaW4iOiJodHRwczovL3d3dy5hbWF6b24uY29tOjQ0MyIsImZlYXR1cmUiOiJQcml2YWN5U2FuZGJveEFkc0FQSXMiLCJleHBpcnkiOjE2ODgwODMxOTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"}},getUserAgent:function(){return navigator.userAgent}}})});"use strict";e.now("StarlingAddMetric").execute(function(f){f||e.register("StarlingAddMetric",function(){return{addMetric:function(a,d){c.ue&&c.ue.count&&
c.ue.count(a,d)}}})});"use strict";e.now("StarlingLogError").execute(function(f){f||e.register("StarlingLogError",function(){return{logError:function(a){var d={logLevel:2<arguments.length&&arguments[2]!==h?arguments[2]:"ERROR",attribution:"StarlingInterestGroupAssignment",message:1<arguments.length&&arguments[1]!==h?arguments[1]:""};c.ueLogError&&c.ueLogError(a,d);return[a,d]}}})});"use strict";e.now("StarlingIGJoinHelpers").execute(function(f){f||e.when("StarlingIGJoinConfiguration","StarlingAddMetric",
"StarlingLogError").register("StarlingIGJoinHelpers",function(a,d,k){function m(){return c.opts.customerId}function e(b){switch(b){case "beta":return"https://at-"+b+".amazon-adsystem.com";case "gamma":return"https://at-"+b+"-us-east.amazon-adsystem.com";case "prod":return"https://at-us-east.amazon-adsystem.com"}}function f(b){if(b){if((b=b.interestGroups)&&Array.isArray(b)&&0<b.length)return d.addMetric("Starling:AttemptedIGAdd",b.length),b;d.addMetric("Starling:GatewayReturnedIGMetadata:False",1);
b={message:"Starling:GatewayReturnedIGMetadata:False. IG Metadata from Gateway is empty or incorrect format."};k.logError(b);return null}d.addMetric("Starling:NullGatewayResponseError",1);b={message:"Starling:NullGatewayResponseError. Null IGMetadata response from Gateway."};k.logError(b)}function q(b,a){return new Promise(function(d,g){try{navigator.joinAdInterestGroup(b,30*a),d()}catch(l){g(l)}})}function n(b,a){var d=[],g=!0,k=!1,c=h;try{for(var e=b[Symbol.iterator](),f;!(g=(f=e.next()).done);g=
!0)d.push(q(f.value,a))}catch(u){k=!0,c=u}finally{try{!g&&e.return&&e.return()}finally{if(k)throw c;}}return d}function p(b,a){var g=0,e=0;b=n(b,a);Promise.allSettled(b).then(function(a){var b=!0,k=!1,c=h;try{for(var f=a[Symbol.iterator](),l;!(b=(l=f.next()).done);b=!0)"fulfilled"===l.value.status?g+=1:e+=1}catch(v){k=!0,c=v}finally{try{!b&&f.return&&f.return()}finally{if(k)throw c;}}d.addMetric("Starling:BrowserAddedToIG:True",g);d.addMetric("Starling:BrowserAddedToIG:False",e);m()?d.addMetric("Starling:IGAssigned:AmazonCustomer",
g):d.addMetric("Starling:IGAssigned:AmazonGuest",g)}).catch(function(b){d.addMetric("Starling:PromiseResolverError",1);k.logError(b,"Starling:PromiseResolveError. Error resolving IGJoinPromiseArray.")})}function r(b){try{return c.localStorage.getItem(b)}catch(g){return null}}function t(b,a){try{b=String(b),a=String(a),c.localStorage.setItem(b,a)}catch(B){}}var w=/development|beta/,x=/pre-prod|gamma/,y=/chrome|chromium|crios/i,z=/opr\//i,A=/edg/i;return{isChrome:function(){var b=a.getUserAgent(),d=
!1;b&&(b.match(y)&&(d=!0),b.match(z)?d=!1:b.match(A)&&(d=!1));return d},browserSupportsAdInterestGroup:function(){return"joinAdInterestGroup"in navigator&&document.featurePolicy.allowsFeature("join-ad-interest-group")},getWindowOpts:function(){return c.opts},getHref:function(){return c.location.href},getCustomerId:m,getApnPrivacySetting:function(){if(null!==document&&null!==document.cookie){var a=document.cookie.match(/(^| )apn-privacy=([^;]+)/);if(a)return"true"===a[2]}return!1},getStage:function(a){return w.test(a)?
"beta":x.test(a)?"gamma":"prod"},generateGatewayUrl:e,provideToken:function(a){if(null!==document&&null!==document.head){var b=document.createElement("meta");b.httpEquiv="origin-trial";b.content=a;document.head.appendChild(b)}},parseIGMetadataFromResponse:f,createIGJoinPromise:q,createIGJoinPromiseArray:n,settleIGJoinPromises:p,joinAdInterestGroups:function(b,c){var m=a.getSecondsPerDay();c=e(c)+"/interestGroups/join/";var g=r("timestampForNextRequest"),l=g?Number(g):0;0==l||l<(new Date).getTime()?
fetch(c,{method:"PUT",body:JSON.stringify(b),credentials:"include"}).then(function(a){d.addMetric("Starling:ReceivedGatewayResponse",1);return a.json()}).then(function(a){var b=JSON.parse(JSON.stringify(a));a=f(b);if(b=b.throttleTimeForNextRequest)l=0==b?0:Number(b)+(new Date).getTime(),t("timestampForNextRequest",l);a&&p(a,m)}).catch(function(a){a instanceof TypeError?(d.addMetric("Starling:FailedToFetchError",1),k.logError(a,"Starling:FailedToFetchError. Error making fetch request.")):(d.addMetric("Starling:ParseGatewayResponseError",
1),k.logError(a,"Starling:ParseGatewayResponseError. Error parsing IG Metadata from Gateway."))}):d.addMetric("Starling:ThrottledIGJoinRequests",1)},lookupLocalStorage:r,addToLocalStorage:t,removeFromLocalStorage:function(a){try{c.localStorage.getItem(a)!==h&&c.localStorage.removeItem(a)}catch(g){}}}})});"use strict";e.now("StarlingInterestGroupAssign").execute(function(c){c||(e.register("StarlingInterestGroupAssign",function(){var a={init:function(d,c,e,f){a.config=d;a.helpers=f;a.metrics=c;a.errors=
e;d=a.config.getRoboticSessionId();c=a.helpers.getHref();a.helpers.isChrome()&&(c?(c=a.helpers.getStage(c),e=a.config.getToken(c),a.helpers.provideToken(e),a.assignIG(c,d)):(a.metrics.addMetric("Starling:PageLoadError",1),a.errors.logError({message:"Starling:PageLoadError. Error retreiving url from window."})))},assignIG:function(c,e){if(a.helpers.browserSupportsAdInterestGroup()){a.metrics.addMetric("Starling:BrowserSupportsAdInterestGroup:True",1);var d=a.helpers.getWindowOpts();if(d){var f=d.sessionId,
k=d.pageType;d=d.asin;var h=a.helpers.getApnPrivacySetting(),n=a.helpers.getHref;e=f===e;var p=a.helpers.getCustomerId();h||e?a.metrics.addMetric("Starling:TotalPunts",1):a.helpers.joinAdInterestGroups({identity:{customerId:p,sessionId:f},pageInformation:{pageURL:n,pageType:k,asins:[d]}},c);h&&a.metrics.addMetric("Starling:UserOptedOut:True",1);e&&a.metrics.addMetric("Starling:RoboticTraffic:True",1);a.helpers.getCustomerId()?a.metrics.addMetric("Starling:BrowserSupportsAdInterestGroup:AmazonCustomer",
1):a.metrics.addMetric("Starling:BrowserSupportsAdInterestGroup:AmazonGuest",1)}else a.metrics.addMetric("Starling:OptsNotFoundError",1),a.errors.logError({message:"Starling:OptsNotFoundError. Error getting windowOpts."})}else a.metrics.addMetric("Starling:BrowserSupportsAdInterestGroup:False",1)}};return a}),e.when("StarlingIGJoinConfiguration","StarlingAddMetric","StarlingLogError","StarlingIGJoinHelpers","StarlingInterestGroupAssign","ready").execute(function(a,c,e,f,h){h.init(a,c,e,f)}))})});